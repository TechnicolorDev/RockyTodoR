(()=>{"use strict";var e,o={4309:(e,o,t)=>{var n=t(4848),s=t(6540),r=t(5338),a=t(181);const i="Rocky-Todos",c=({element:e,requiredRole:o})=>{const t=(0,a.zy)(),s=localStorage.getItem(`${i}-session-jwtToken`)||sessionStorage.getItem(`${i}-session-jwtToken`),r=localStorage.getItem(`${i}-session-userId`)||sessionStorage.getItem(`${i}-session-userId`),c=localStorage.getItem(`${i}-session-role`)||sessionStorage.getItem(`${i}-session-role`),l=!!s&&!!r,d=c===o||"admin"===c;return l&&"/login"===t.pathname?(0,n.jsx)(a.C5,{to:"/",replace:!0}):l?l&&!d?(0,n.jsx)(a.C5,{to:"/forbidden",replace:!0}):e:(0,n.jsx)(a.C5,{to:"/login",replace:!0})};var l=t(2845),d=(t(3482),t(1083)),u=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};d.A.defaults.withCredentials=!0,d.A.defaults.baseURL="http://localhost:3000";const h="Rocky-Todos",m="api",p="fACEbLcmw9RV7sn4xkjC4oPc",v=()=>localStorage.getItem(`${h}-session-csrfToken`);d.A.interceptors.request.use((e=>{const o=v();return o&&(e.headers["X-CSRF-Token"]=o),e}),(e=>Promise.reject(e)));d.A.interceptors.request.use((e=>{const o=v();return o&&(e.headers["X-CSRF-Token"]=o),e.headers.Authorization=`Bearer ${p}`,e}),(e=>Promise.reject(e)));const f=()=>u(void 0,void 0,void 0,(function*(){try{const e=yield d.A.get("/api/todos");return Array.isArray(e.data)?e.data:(console.error("Response is not an array:",e.data),[])}catch(e){return console.error("Error fetching todos:",e),[]}})),g=()=>u(void 0,void 0,void 0,(function*(){try{const e=yield d.A.get("/api/admin/colors");return console.log("Response from getColors:",e),e.data}catch(e){throw console.error("Error fetching colors:",e),e}}));var x=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const j=(0,s.createContext)(null),y=({children:e})=>{const[o,t]=(0,s.useState)(null),[r,a]=(0,s.useState)(!0),i=()=>x(void 0,void 0,void 0,(function*(){try{const e=yield g();t(e),c(e)}catch(e){console.error("Error fetching colors:",e)}finally{a(!1)}})),c=e=>{Object.keys(e).forEach((o=>{const t=o;document.documentElement.style.setProperty(`--${t}`,e[t])}))};(0,s.useEffect)((()=>{i()}),[]);return r?(0,n.jsx)("div",{children:"Loading colors..."}):(0,n.jsx)(j.Provider,{value:{colors:o,handleSaveColor:(e,o)=>x(void 0,void 0,void 0,(function*(){try{yield((e,o)=>u(void 0,void 0,void 0,(function*(){try{const t=yield d.A.post("/api/admin/colors",{name:e,value:o});return console.log("Response from updateColor:",t),t.data}catch(e){throw console.error("Error updating color:",e),e}})))(e,o),t((t=>t?Object.assign(Object.assign({},t),{[e]:o}):t)),document.documentElement.style.setProperty(`--${e}`,o)}catch(e){console.error("Error saving color:",e)}})),handleResetColors:()=>x(void 0,void 0,void 0,(function*(){try{yield u(void 0,void 0,void 0,(function*(){try{const e=yield d.A.post("/api/admin/colors/reset");return console.log("Response from resetColors:",e),e.data}catch(e){throw console.error("Error resetting colors:",e),e}})),i()}catch(e){console.error("Error resetting colors:",e)}}))},children:e})};var w=t(9418),b=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const N=()=>{const[e,o]=(0,s.useState)({name:"",email:"",password:""}),t=(0,a.Zp)(),r=e=>w.A.sanitize(e),i=t=>{const n=r(t.target.value);o(Object.assign(Object.assign({},e),{[t.target.name]:n}))};return(0,n.jsxs)("div",{className:"install",children:[(0,n.jsx)("h1",{children:"Admin Setup"}),(0,n.jsxs)("form",{onSubmit:o=>b(void 0,void 0,void 0,(function*(){o.preventDefault(),l.oR.error(null);const n=r(e.name),s=r(e.email),a=r(e.password);var i;if((i=a).length<5?(l.oR.error("Password must be at least 5 characters long."),0):!["123456","password","123456789","12345","1234","qwerty","abc123","password1","letmein","monkey","123123"].includes(i)||(l.oR.error("Password is too common. Please choose a stronger password."),0))try{yield(e=>{const o=v(),t=`Bearer ${p}`;return console.log("Making POST request to install admin"),console.log("CSRF Token:",o),console.log("Authorization Token:",t),console.log("Request Data:",e),d.A.post(`${m}/install`,e,{headers:{"X-CSRF-Token":o,"Content-Type":"application/json"}}).then((e=>(console.log("Response:",e),e))).catch((e=>{console.error("Error occurred during installation:",e),e.response?(console.error("Error Response:",e.response),console.error("Error Status:",e.response.status),console.error("Error Headers:",e.response.headers),console.error("Error Data:",e.response.data)):console.error("Error without response:",e)}))})({name:n,email:s,password:a}),l.oR.success("You are all set! Get to work."),t("/login")}catch(e){l.oR.error("Failed to create admin: "+e)}})),children:[(0,n.jsx)("input",{type:"text",name:"name",placeholder:"Name",onChange:i}),(0,n.jsx)("input",{type:"email",name:"email",placeholder:"Email",onChange:i}),(0,n.jsx)("input",{type:"password",name:"password",placeholder:"Password",onChange:i}),(0,n.jsx)("button",{type:"submit",children:"Setup Admin"})]})]})};var S=t(2832);const R=({children:e,delay:o=0,className:t="",flexDirection:r="row",displayOpt:a="block"})=>{const[i,c]=(0,s.useState)(!1),l=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=new IntersectionObserver((o=>{o.forEach((o=>{o.isIntersecting&&!i&&(c(!0),e.unobserve(o.target))}))}),{threshold:.1,rootMargin:"0px 0px -110px 0px"});return l.current&&e.observe(l.current),()=>{l.current&&e.unobserve(l.current)}}),[i]),(0,n.jsx)(S.P.div,{ref:l,className:`${t} animated-container`,initial:{opacity:0,y:30},animate:{opacity:i?1:0,y:i?0:30},transition:{duration:.6,delay:i?o/1e3:0,ease:[.65,0,.35,1]},style:{position:"relative",transformOrigin:"center center",width:"100%",display:"flex"===a?"flex":"block",flexDirection:"flex"===a?r:void 0},children:e})},C=({children:e,delay:o=0})=>{const[t,r]=(0,s.useState)(!1),a=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=new IntersectionObserver((o=>{o.forEach((o=>{o.isIntersecting&&!t&&(r(!0),e.unobserve(o.target))}))}),{threshold:.1,rootMargin:"0px 0px -120px 0px"});return a.current&&e.observe(a.current),()=>{a.current&&e.unobserve(a.current)}}),[t]),(0,n.jsxs)(S.P.div,{ref:a,initial:{opacity:0,y:20,scale:.95},animate:{opacity:t?1:0,y:t?0:20,scale:t?1:.95},transition:{duration:.6,delay:t?o/1e3:0,ease:[.68,-.55,.27,1.55]},style:{position:"relative",zIndex:1001,willChange:"transform, opacity, scale"},className:"loaded-animation",children:[e," "]})},k=({children:e,delay:o=0})=>{const[t,r]=(0,s.useState)(!1),a=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=new IntersectionObserver((o=>{o.forEach((o=>{o.isIntersecting&&!t&&(r(!0),e.unobserve(o.target))}))}),{threshold:.1,rootMargin:"0px 0px -120px 0px"});return a.current&&e.observe(a.current),()=>{a.current&&e.unobserve(a.current)}}),[]),(0,n.jsxs)(S.P.div,{ref:a,initial:{opacity:0,x:50},animate:{opacity:t?1:0,x:t?0:50},transition:{duration:.6,delay:t?o/1e3:0,ease:[.68,-.55,.27,1.55]},className:"loaded-animation",style:{position:"relative",zIndex:1001,willChange:"transform, opacity"},children:[e," "]})};var E=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const I=()=>{const[e,o]=(0,s.useState)({email:"",password:""}),[t,r]=(0,s.useState)(!1),i=(0,a.Zp)();(0,s.useEffect)((()=>{document.cookie.split("; ").find((e=>e.startsWith("token=")))&&i("/admin")}),[i]);const c=t=>{var n;o(Object.assign(Object.assign({},e),{[t.target.name]:(n=t.target.value,w.A.sanitize(n.trim()))}))};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"login-wrapper",children:(0,n.jsx)(R,{children:(0,n.jsx)("div",{className:"login",children:(0,n.jsxs)("form",{onSubmit:o=>E(void 0,void 0,void 0,(function*(){o.preventDefault(),r(!0);try{const o=yield(t=e,u(void 0,void 0,void 0,(function*(){try{const e=yield d.A.post("/api/login",t,{withCredentials:!0});console.log("Login Response Data: ",e.data),console.log("Login successful! JWT token is set in the cookies (HttpOnly).");const{message:o,userId:n,role:s}=e.data;localStorage.setItem(`${h}-session-userId`,n),localStorage.setItem(`${h}-session-role`,s);const r=document.cookie;return console.log("Cookies after login attempt:",r),{message:o,userId:n,role:s}}catch(e){throw console.error("Error logging in",e),new Error("Login failed. Please check your credentials and try again.")}})));console.log(o.message),"Login successful"===o.message?(console.log("Redirecting to home"),setTimeout((()=>{i("/admin")}),1e3)):l.oR.error("Login failed.")}catch(e){console.error("Error logging in:",e),l.oR.error("Login failed.")}finally{r(!1)}var t})),children:[(0,n.jsx)(C,{delay:200,children:(0,n.jsxs)("h1",{className:"text-login",children:["Login | ","Rocky-Todos"]})}),(0,n.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:e.email,onChange:c,required:!0,className:"login-input"}),(0,n.jsx)(k,{delay:550,children:(0,n.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:e.password,onChange:c,required:!0,className:"login-input"})}),(0,n.jsx)(C,{delay:700,children:(0,n.jsx)("button",{type:"submit",className:"loginb-btn",disabled:t,children:"Log In"})}),(0,n.jsx)(R,{children:(0,n.jsx)("a",{className:"forgot-password-text",href:"/forgot-password",children:"Forgot password"})})]})})})})})},T=({children:e,delay:o=0})=>{const[t,r]=(0,s.useState)(!1),a=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=new IntersectionObserver((o=>{o.forEach((o=>{o.isIntersecting&&!t&&(r(!0),e.unobserve(o.target))}))}),{threshold:.1,rootMargin:"0px 0px -120px 0px"});return a.current&&e.observe(a.current),()=>{a.current&&e.unobserve(a.current)}}),[]),(0,n.jsx)(S.P.div,{ref:a,initial:{opacity:0,x:-50},animate:{opacity:t?1:0,x:t?0:-50},transition:{duration:.6,delay:t?o/1e3:0,ease:[.68,-.55,.27,1.55]},className:"loaded-animation",style:{position:"relative",zIndex:1001,willChange:"transform, opacity"},children:e})},P=({todo:e})=>{const o=(0,a.Zp)(),t=new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(e.dueDate));return(0,n.jsxs)("div",{className:"todo-item",children:[(0,n.jsx)(C,{delay:100,children:(0,n.jsx)("h3",{className:"todo-item-h3",children:e.name})}),(0,n.jsx)(T,{delay:200,children:(0,n.jsx)("p",{className:"todo-item-p1",children:e.description})}),(0,n.jsx)(T,{delay:300,children:(0,n.jsxs)("p",{className:"todo-item-p2",children:["Due: ",t]})}),(0,n.jsxs)(R,{flexDirection:"column",displayOpt:"flex",children:[(0,n.jsx)("a",{href:e.repoUrl,target:"_blank",rel:"noopener noreferrer",className:"todo-item-p3",children:"Repo"}),(0,n.jsx)("button",{onClick:()=>o(`/todos/edit/${e.todoId}`),className:"todo-item-btn",children:"Edit"})]})]})},A="Rocky-Todos",O=()=>{const e=(0,a.Zp)();return(0,n.jsx)("button",{onClick:()=>{localStorage.removeItem(`${A}-session-jwtToken`),localStorage.removeItem(`${A}-session-csrfToken`),localStorage.removeItem(`${A}-session-userId`),localStorage.removeItem(`${A}-session-role`),sessionStorage.removeItem(`${A}-session-jwtToken`),sessionStorage.removeItem(`${A}-session-csrfToken`),sessionStorage.removeItem(`${A}-session-userId`),sessionStorage.removeItem(`${A}-session-role`),console.log("Application session has been cleared."),e("/login")},className:"logout-btn",children:"Logout"})};var D=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const $=()=>{const[e,o]=(0,s.useState)([]),t=(0,a.Zp)();return(0,s.useEffect)((()=>{D(void 0,void 0,void 0,(function*(){const e=yield f();o(e)}))}),[]),(0,n.jsxs)("div",{className:"todos",children:[(0,n.jsx)(O,{}),(0,n.jsx)(R,{children:(0,n.jsx)("h1",{className:"todo-list-h1",children:"Todo List"})}),0===e.length&&(0,n.jsx)("p",{className:"todo-list-p1",children:"No todos found, please add some!"}),(0,n.jsx)("button",{onClick:()=>t("/todos/create"),className:"todo-list-btn",children:"Create Todo"}),(0,n.jsx)(R,{children:(0,n.jsx)("div",{className:"todo-list",children:e.map((e=>(0,n.jsx)(P,{todo:e},e.todoId)))})})]})};var F=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const q=()=>{const e=(0,a.Zp)(),[o,t]=(0,s.useState)({name:"",description:"",dueDate:"",repoUrl:""}),[r,i]=(0,s.useState)(null),c=e=>{t(Object.assign(Object.assign({},o),{[e.target.name]:e.target.value}))};return(0,n.jsxs)("div",{className:"todo-create",children:[(0,n.jsx)("h1",{className:"create-h1",children:"Create Todo"}),r&&(0,n.jsx)("p",{className:"error",children:r}),(0,n.jsxs)("form",{onSubmit:t=>F(void 0,void 0,void 0,(function*(){t.preventDefault();const n={name:w.A.sanitize(o.name),description:w.A.sanitize(o.description),dueDate:w.A.sanitize(o.dueDate),repoUrl:w.A.sanitize(o.repoUrl)};try{const o=yield(s=n,u(void 0,void 0,void 0,(function*(){try{return(yield d.A.post(`${m}/todos`,s)).data}catch(e){throw console.error("Error creating todo:",e),e}})));console.log("Todo created:",o),e("/"),l.oR.success("Todo successfully created!")}catch(e){l.oR.error("Failed to create todo, all fields are required"),console.error("Failed to create todo:",e)}var s})),children:[(0,n.jsx)("input",{type:"text",name:"name",placeholder:"Name",value:o.name,onChange:c,className:"todo-create-input"}),(0,n.jsx)("input",{type:"text",name:"description",placeholder:"Description",value:o.description,onChange:c,className:"todo-create-input"}),(0,n.jsx)("input",{type:"date",name:"dueDate",value:o.dueDate,onChange:c,className:"todo-create-input"}),(0,n.jsx)("input",{type:"url",name:"repoUrl",placeholder:"Repo URL",value:o.repoUrl,onChange:c,className:"todo-create-input"}),(0,n.jsx)("button",{type:"submit",className:"create-btn",children:"Create Todo"})]})]})},U=({isOpen:e,onClose:o,onConfirm:t,message:s})=>e?(0,n.jsx)("div",{className:"modal-overlay",children:(0,n.jsxs)("div",{className:"modal-container",children:[(0,n.jsx)("h2",{children:s}),(0,n.jsxs)("div",{className:"modal-actions",children:[(0,n.jsx)("button",{className:"modal-button",onClick:t,children:"Yes, Delete"}),(0,n.jsx)("button",{className:"modal-button",onClick:o,children:"Cancel"})]})]})}):null;var z=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const L=()=>{const[e,o]=(0,s.useState)({name:"",description:"",dueDate:"",repoUrl:""}),[t,r]=(0,s.useState)(null),i=(0,a.Zp)(),[c,v]=(0,s.useState)(!1),{id:g}=(0,a.g)();(0,s.useEffect)((()=>{z(void 0,void 0,void 0,(function*(){if(g)try{const e=(yield f()).find((e=>e.todoId===g));e?o({name:e.name,description:e.description,dueDate:new Date(e.dueDate).toISOString().slice(0,10),repoUrl:e.repoUrl}):(console.error("Todo not found"),l.oR.error("Todo not found!"))}catch(e){console.error("Error fetching todo details:",e),l.oR.error("Error fetching todoId! Check console for more details")}else console.error("Todo ID is missing")}))}),[g]);const x=e=>{const{name:t,value:n}=e.target;o((e=>Object.assign(Object.assign({},e),{[t]:n})))},j=()=>z(void 0,void 0,void 0,(function*(){var e;if(g)try{yield(e=g,u(void 0,void 0,void 0,(function*(){try{const o=yield d.A.delete(`${m}/todos/${e}`);return console.log("Response from delete:",o),o.data}catch(e){throw console.error("Error deleting todo:",e),e}}))),l.oR.success("Todo deleted successfully!"),v(!1),i("/")}catch(e){console.error("Error deleting todo:",e),l.oR.error("Failed to delete the todo.")}else l.oR.error("Todo ID is missing.")}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("form",{onSubmit:o=>z(void 0,void 0,void 0,(function*(){if(o.preventDefault(),!(g&&e.name&&e.description&&e.dueDate&&e.repoUrl))return console.error("Todo ID or data is missing."),void l.oR.warning("Please fill out all fields.");try{yield(t=g,n=e,u(void 0,void 0,void 0,(function*(){try{const e=localStorage.getItem(`${h}-session-csrfToken`),o=yield d.A.patch(`${m}/todos/${t}`,n,{headers:{"Content-Type":"application/json","X-CSRF-Token":e,Authorization:`Bearer ${p}`}});console.log("Response:",o.data)}catch(e){d.A.isAxiosError(e)?(console.error("AxiosError:",e),console.error("Error response:",e.response),console.error("Error request:",e.request),console.error("Error message:",e.message),console.error("Error config:",e.config)):console.error("Unknown error:",e)}}))),l.oR.success("Todo updated successfully!"),i("/")}catch(e){console.error("Error editing todo:",e),l.oR.error("Failed to update the todo.")}var t,n})),className:"edit-todo",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"edit-todo-h1",children:"Edit Todo"}),(0,n.jsx)("label",{className:"edit-todo-label",children:"Name"}),(0,n.jsx)("input",{type:"text",name:"name",value:e.name,onChange:x,className:"edit-todo-input"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Description"}),(0,n.jsx)("input",{type:"text",name:"description",value:e.description,onChange:x,className:"edit-todo-input"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Due Date"}),(0,n.jsx)("input",{type:"date",name:"dueDate",value:e.dueDate,onChange:x,className:"edit-todo-input"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Repo URL"}),(0,n.jsx)("input",{type:"text",name:"repoUrl",value:e.repoUrl,onChange:x,className:"edit-todo-input"})]}),t&&(0,n.jsx)("div",{className:"error",children:t}),(0,n.jsx)("button",{type:"submit",className:"edit-todo-btn",children:"Update Todo"}),(0,n.jsx)("button",{type:"button",onClick:j,className:"edit-todo-delete",children:"Delete Todo"})]}),(0,n.jsx)(U,{isOpen:c,onClose:()=>{v(!1)},onConfirm:j,message:"Are you sure you want to delete this Todo?"})]})};var M=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const Z=()=>{const[e,o]=(0,s.useState)(""),[t,r]=(0,s.useState)(""),[a,i]=(0,s.useState)("");return(0,n.jsxs)("div",{className:"forgot-password-div",children:[(0,n.jsx)("h2",{className:"forgot-password-h1",children:"Forgot Password"}),(0,n.jsxs)("form",{onSubmit:o=>M(void 0,void 0,void 0,(function*(){o.preventDefault(),i(""),r("");const t=(n=e,w.A.sanitize(n));var n;if(!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(t))return i("Invalid email address."),void l.oR.error("Invalid email address.");try{yield(e=>u(void 0,void 0,void 0,(function*(){try{const o=yield d.A.post("/api/emails/forgot-password",{email:e});console.log("Response Data:",o.data);const t=o.data.token||o.data.toke;if(t){const e={token:t,expiration:Date.now()+36e5};localStorage.setItem(`${h}-session-csrfToken`,JSON.stringify(e)),console.log("CSRF Token stored in localStorage:",e)}else console.error("No CSRF token received in response data");console.log("Password reset email sent successfully.")}catch(e){console.error("Error sending password reset email:",e)}})))(t);l.oR.success("If this email exists, a password reset link has been sent."),r("Check your inbox for further instructions.")}catch(e){l.oR.error("There was an error sending the password reset email."),i("Failed to send the reset email. Please try again later.")}})),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"email",className:"forgot-password-email",children:"Email"}),(0,n.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>o(e.target.value),required:!0,className:"forgot-password-email-input"})]}),(0,n.jsx)("button",{type:"submit",className:"forgot-password-submit",children:"Send Password Reset Email"})]}),t&&(0,n.jsx)("p",{style:{color:"green"},children:w.A.sanitize(t)}),a&&(0,n.jsx)("p",{style:{color:"red"},children:w.A.sanitize(a)})]})};var B=t(7065),_=t.n(B),H=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const X=()=>{const[e,o]=(0,s.useState)(""),[t,r]=(0,s.useState)(""),[i,c]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),[v,f]=(0,s.useState)(!1),g=(0,a.zy)(),x=(0,a.Zp)(),j=new URLSearchParams(g.search).get("token");(0,s.useEffect)((()=>{j||l.oR.error("Invalid or missing token")}),[j]);const y=e=>w.A.sanitize(e);return(0,n.jsxs)("div",{className:"reset-password-container",children:[(0,n.jsx)("h2",{className:"reset-password-h1",children:"Reset Your Passwor"}),i&&(0,n.jsx)("p",{style:{color:"red"},children:w.A.sanitize(i)}),m&&(0,n.jsx)("p",{style:{color:"green"},children:w.A.sanitize(m)}),(0,n.jsxs)("form",{onSubmit:o=>H(void 0,void 0,void 0,(function*(){var n,s;o.preventDefault(),c(""),p("");const r=y(e),a=y(t);if(r.length<5)return l.oR.error("Password must be at least 5 characters long."),void c("Password must be at least 5 characters long.");if(i=r,!(_()(i).score>=3))return l.oR.error("Password is too weak. Please choose a stronger password."),void c("Password is too weak. Please choose a stronger password.");var i;if(r!==a)return l.oR.error("Passwords do not match."),void c("Passwords do not match.");if(j){f(!0);try{const e=yield((e,o)=>u(void 0,void 0,void 0,(function*(){try{const t=JSON.parse(localStorage.getItem(`${h}-session-csrfToken`)||"{}");if(!t.token)throw new Error("CSRF token is missing");if(Date.now()>t.expiration)throw localStorage.removeItem(`${h}-session-csrfToken`),new Error("CSRF token has expired");const n=t.token;console.log("Sending request with CSRF Token:",n);const s=yield d.A.post("/api/emails/reset-password",{token:e,newPassword:o},{headers:{"Content-Type":"application/json","X-CSRF-Token":n}});return console.log("Response Data:",s.data),console.log("Response Headers:",s.headers),s.data}catch(e){throw console.error("Error resetting password:",e),e}})))(j,r);l.oR.success(e.message||"Password reset successfully!"),x("/login")}catch(e){console.error("Error details:",e),l.oR.error((null===(s=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===s?void 0:s.error)||"Failed to reset password. Please try again.")}finally{f(!1)}}else c("Invalid token, please try again.")})),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"new-password",children:"New Password"}),(0,n.jsx)("input",{type:"password",id:"new-password",value:e,onChange:e=>o(e.target.value),required:!0,className:"reset-password-input"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"confirm-password",children:"Confirm Password"}),(0,n.jsx)("input",{type:"password",id:"confirm-password",value:t,onChange:e=>r(e.target.value),required:!0,className:"reset-password-input"})]}),(0,n.jsx)("button",{type:"submit",disabled:v,className:"reset-password-btn",children:v?"Resetting...":"Reset Password"})]})]})},Y={ADMIN:"admin",USER:"user"};var J=t(937);const V=Y.USER,G={main:[{path:"/",component:$,protected:!0,requiredRole:Y.USER,exact:!0},{path:"/forbidden",component:()=>(0,n.jsx)("div",{className:"forbidden-container",children:(0,n.jsxs)("div",{className:"forbidden-content",children:[(0,n.jsx)("img",{src:"https://source.unsplash.com/1600x900/?warning,forbidden",alt:"Forbidden",className:"forbidden-image"}),(0,n.jsxs)("div",{className:"message",children:[(0,n.jsx)(J.BS8,{className:"warning-icon"}),(0,n.jsx)("h2",{children:"403 Forbidden"}),(0,n.jsx)("p",{children:"You do not have permission to access this page."})]})]})}),protected:!0,requiredRole:Y.USER,exact:!0},{path:"/todos/create",component:q,protected:!0},{path:"/login",component:I,protected:!1},{path:"/install",component:N,protected:!1},{path:"/todos/edit/:id",component:L,protected:!0},{path:"/forgot-password",component:Z,protected:!1},{path:"/reset-password",component:X,protected:!1}].map((e=>Object.assign(Object.assign({},e),{requiredRole:e.requiredRole||V})))};var W=t(5189),K=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const Q=()=>{const{colors:e,handleSaveColor:o,handleResetColors:t}=(()=>{const e=(0,s.useContext)(j);if(!e)throw new Error("useColors must be used within a ColorProvider");return e})(),[r,a]=(0,s.useState)(null),[i,c]=(0,s.useState)(""),[l,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)("");return(0,s.useEffect)((()=>{const e=e=>{var o;r&&!(null===(o=document.getElementById("color-picker"))||void 0===o?void 0:o.contains(e.target))&&d(!1)};return l&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[l,r]),e?(0,n.jsxs)("div",{className:"color-settings",children:[(0,n.jsx)("h2",{children:"Color Settings"}),(0,n.jsx)("div",{className:"colors-list",children:Object.entries(e).map((([o,t])=>(0,n.jsxs)("div",{className:"color-item",children:[(0,n.jsxs)("span",{children:[o,":"]}),(0,n.jsx)("span",{className:"color-box",style:{backgroundColor:t}}),(0,n.jsx)("button",{className:"edit-btn",onClick:()=>(o=>{a(o),c(e[o]||""),h(e[o]||""),d(!0)})(o),children:"Edit"})]},o)))}),r&&l&&(0,n.jsxs)("div",{className:"edit-section",id:"color-picker",children:[(0,n.jsxs)("h3",{children:["Edit ",r]}),(0,n.jsx)(W.xk,{color:i,onChange:e=>{c(e.hex),h(e.hex)}}),(0,n.jsx)("button",{className:"save-btn",onClick:()=>K(void 0,void 0,void 0,(function*(){r&&i&&(yield o(r,i),a(null),c(""),d(!1))})),children:"Save"})]}),(0,n.jsxs)("div",{className:"edit-section",children:[(0,n.jsx)("button",{className:"save-btn",onClick:()=>K(void 0,void 0,void 0,(function*(){if(e)try{for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];yield o(t,n)}console.log("All colors saved!")}catch(e){console.error("Error saving all colors:",e)}else console.error("No colors available to save")})),children:"Save All"}),(0,n.jsx)("button",{className:"reset-btn",onClick:()=>K(void 0,void 0,void 0,(function*(){yield t()})),children:"Reset All"})]})]}):(0,n.jsx)("div",{children:"Loading colors..."})},ee=()=>{const[e,o]=(0,s.useState)(!1),t=(0,a.zy)(),r=e=>t.pathname===e?"active":"";return(0,n.jsxs)("div",{className:"admin-page",children:[(0,n.jsx)("button",{className:"admin-page-sidebar-button",onClick:()=>{o(!e)},style:{display:e?"none":"block"},children:"☰ "}),(0,n.jsxs)("aside",{className:"admin-page-sidebar "+(e?"open":""),children:[(0,n.jsx)("div",{className:"admin-page-header",children:(0,n.jsx)("h1",{children:"Rocky-Todos"})}),(0,n.jsxs)("section",{className:"sidebar-section",children:[(0,n.jsx)("h2",{children:"Overview"}),(0,n.jsx)("nav",{className:"admin-page-nav-menu",children:(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/todos",className:`admin-page-a ${r("/admin/todos")}`,children:[(0,n.jsx)(J.w8j,{})," Todos"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/users",className:`admin-page-a ${r("/admin/users")}`,children:[(0,n.jsx)(J.x$1,{})," Users"]})})]})})]}),(0,n.jsxs)("section",{className:"sidebar-section",children:[(0,n.jsx)("h2",{children:"Edit"}),(0,n.jsx)("nav",{className:"admin-page-nav-menu",children:(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/users",className:`admin-page-a ${r("/admin/edit/users")}`,children:[(0,n.jsx)(J.xvZ,{})," Users"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/todos",className:`admin-page-a ${r("/admin/edit/todos")}`,children:[(0,n.jsx)(J.w8j,{})," Todos"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/assignments",className:`admin-page-a ${r("/admin/assignments")}`,children:[(0,n.jsx)(J.umw,{})," Assignments"]})})]})})]}),(0,n.jsxs)("section",{className:"sidebar-section",children:[(0,n.jsx)("h2",{children:"Customize"}),(0,n.jsx)("nav",{className:"admin-page-nav-menu",children:(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/colors",className:`admin-page-a ${r("/admin/colors")}`,children:[(0,n.jsx)(J.lV_,{})," Colors"]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("a",{href:"/admin/elements",className:`admin-page-a ${r("/admin/elements")}`,children:[(0,n.jsx)(J.Pcn,{})," Elements"]})})]})})]})]}),(0,n.jsxs)("main",{className:"admin-page-content",children:[(0,n.jsx)(a.sv,{})," "]})]})};var oe=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const te=Y.ADMIN,ne={main:[{path:"/admin",component:ee,protected:!0,exact:!0,protectedRole:Y.ADMIN,children:[{path:"colors",component:Q,protected:!0,protectedRole:Y.ADMIN},{path:"users",component:Q,protected:!0,protectedRole:Y.ADMIN},{path:"todos",component:()=>{const[e,o]=(0,s.useState)([]);(0,a.Zp)();return(0,s.useEffect)((()=>{oe(void 0,void 0,void 0,(function*(){const e=yield f();o(e)}))}),[]),(0,n.jsx)("div",{className:"todos",children:(0,n.jsx)(R,{children:(0,n.jsx)("div",{className:"todo-list",children:e.map((e=>(0,n.jsx)(P,{todo:e},e.todoId)))})})})},protected:!0,protectedRole:Y.ADMIN}]}].map((e=>Object.assign(Object.assign({},e),{requiredRole:e.protectedRole||te})))};var se=function(e,o,t,n){return new(t||(t=Promise))((function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function i(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var o;e.done?s(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(a,i)}c((n=n.apply(e,o||[])).next())}))};const re=()=>{const[e,o]=(0,s.useState)(!1),[t,r]=(0,s.useState)(!0);if((0,s.useEffect)((()=>{se(void 0,void 0,void 0,(function*(){try{const e=yield g(),t=document.createElement("style");t.innerHTML=`:root {\n                ${Object.entries(e).map((([e,o])=>`${e}: ${o};`)).join(" ")}\n            }`,document.head.appendChild(t),o(!0)}catch(e){console.error("Error preloading colors:",e),o(!0)}}))}),[]),(0,s.useEffect)((()=>{e&&setTimeout((()=>r(!1)),500)}),[e]),t)return(0,n.jsx)("div",{children:"Loading..."});const i=(e,o=!1)=>e.map((e=>{const{path:o,component:t,protected:s,requiredRole:r,children:l}=e,d=(0,n.jsx)(t,{});return s?(0,n.jsxs)(a.qh,{path:o,element:(0,n.jsx)(c,{element:d,requiredRole:r}),children:[l&&i(l)," "]},o):(0,n.jsx)(a.qh,{path:o,element:d},o)}));return(0,n.jsx)(y,{children:(0,n.jsx)(a.Kd,{children:(0,n.jsxs)("div",{className:"app",children:[(0,n.jsx)(l.N9,{autoClose:5e3,position:"top-right",hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),(0,n.jsxs)(a.BV,{children:[i(G.main),i(ne.main,!0)," "]})]})})})};r.createRoot(document.getElementById("root")).render((0,n.jsx)(s.StrictMode,{children:(0,n.jsx)(re,{})}))}},t={};function n(e){var s=t[e];if(void 0!==s)return s.exports;var r=t[e]={id:e,loaded:!1,exports:{}};return o[e](r,r.exports,n),r.loaded=!0,r.exports}n.m=o,e=[],n.O=(o,t,s,r)=>{if(!t){var a=1/0;for(d=0;d<e.length;d++){t=e[d][0],s=e[d][1],r=e[d][2];for(var i=!0,c=0;c<t.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every((e=>n.O[e](t[c])))?t.splice(c--,1):(i=!1,r<a&&(a=r));if(i){e.splice(d--,1);var l=s();void 0!==l&&(o=l)}}return o}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[t,s,r]},n.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return n.d(o,{a:o}),o},n.d=(e,o)=>{for(var t in o)n.o(o,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={792:0,869:0};n.O.j=o=>0===e[o];var o=(o,t)=>{var s,r,a=t[0],i=t[1],c=t[2],l=0;if(a.some((o=>0!==e[o]))){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(c)var d=c(n)}for(o&&o(t);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},t=self.webpackChunkuntitled3=self.webpackChunkuntitled3||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))})();var s=n.O(void 0,[96,869],(()=>n(4309)));s=n.O(s)})();